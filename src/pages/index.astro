---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/PostCard.astro';
import Notice from '../components/Notice.astro';
import { getCollection } from 'astro:content';

// Get the base path from the config
const base = import.meta.env.BASE_URL;

// Get latest news posts
const allPosts = await getCollection('news');
const sortedPosts = allPosts.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
const latestPost = sortedPosts[0];

// Import config
const config = await import('../../data/config.json');
---

<BaseLayout title="Home - Queens Park Rangers U11B">
  <!-- Hero Section -->
  <section class="hero field-pattern">
    <div class="container">
      <h1 class="soccer-bounce">âš½ Queens Park Rangers âš½</h1>
      <p><strong>U11 Boys â€¢ Coquitlam Metro-Ford SC â€¢ Season 2025-2026</strong></p>
      <p>Welcome to our team website! Stay updated with practice schedules, news, and everything QPR. ğŸ†</p>
    </div>
  </section>

  <div class="container">
    <div class="grid grid-2" style="margin-top: var(--spacing-2xl);">
      
      <!-- This Week Section -->
      <div>
        <h2>This Week</h2>
        {latestPost ? (
          <PostCard 
            title={latestPost.data.title}
            date={latestPost.data.date}
            summary={latestPost.data.summary}
            slug={latestPost.slug}
            tags={latestPost.data.tags}
          />
        ) : (
          <div class="card">
            <p>No recent news posts. Check back soon!</p>
          </div>
        )}
      </div>

      <!-- Quick Info Section -->
      <div>
        <h2 class="soccer-icon">Quick Info</h2>
        
        <div class="card card-highlight team-highlight">
          <h3>ğŸƒâ€â™‚ï¸ Practice Details</h3>
          <p><strong>{config.practice_day}</strong><br>
          {config.practice_time}<br>
          {config.practice_location}</p>
          <a href={`${base}schedule/`} class="btn btn-small">Full Schedule â†’</a>
        </div>

        <div class="card game-card" style="margin-top: var(--spacing-lg);">
          <h3>ğŸ† First Game</h3>
          <p>{config.first_game_weekend}</p>
          <p><em>Fixture details will be posted once available</em></p>
        </div>

        <div class="card game-card" style="margin-top: var(--spacing-lg);">
          <h3>ğŸ‘• Kit Information</h3>
          <p>Pickup windows and exchange details</p>
          <a href={`${base}kits/`} class="btn btn-small">Kit Details â†’</a>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <section style="margin-top: var(--spacing-2xl);">
      <h2 class="soccer-icon">Quick Links</h2>
      <div class="grid grid-3">
        <a href={`${base}team-goals/`} class="card game-card" style="text-decoration: none; color: inherit;">
          <h3>ğŸ¯ Team Goals</h3>
          <p>Track our season achievements and progress</p>
        </a>
        
        <a href={`${base}matches/`} class="card game-card" style="text-decoration: none; color: inherit;">
          <h3>ğŸŸï¸ Match Center</h3>
          <p>View games, scores, and highlights</p>
        </a>
        
        <a href={`${base}achievements/`} class="card game-card" style="text-decoration: none; color: inherit;">
          <h3>ğŸ† Achievements</h3>
          <p>Unlock badges and track your progress</p>
        </a>
        
        <a href={`${base}roster/`} class="card game-card" style="text-decoration: none; color: inherit;">
          <h3>ğŸ‘¥ Team Roster</h3>
          <p>Meet the QPR U11B squad</p>
        </a>
        
        <a href={`${base}downloads/`} class="card game-card" style="text-decoration: none; color: inherit;">
          <h3>ğŸ“„ Downloads</h3>
          <p>Forms, checklists, and important documents</p>
        </a>
      </div>
    </section>

    <!-- Important Notice -->
    <Notice type="info" title="New Season Updates">
      <p>We're preparing for an exciting 2025-2026 season! Keep checking back for the latest updates on practice schedules, game fixtures, and important announcements.</p>
    </Notice>
  </div>
</BaseLayout>
